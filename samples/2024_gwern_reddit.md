---
title: Hardware Hedging Against Scaling Regime Shifts (self.mlscaling)
url: https://old.reddit.com/r/mlscaling/comments/1eyophn/hardware_hedging_against_scaling_regime_shifts/
novelty: 1.0
date: 2024-08-21
---
Hyperscalers are investing heavily in AMD/Nvidia-style GPUs optimized for moderate-scale parallelism: less than almost-shared-nothing scientific computing tasks like SETI@home, but not strictly sequential like highly-branching tasks, and with the best interconnects money can buy in a custom datacenter, probably topping out at somewhere ~1m GPUs before the communication overhead/latency & Amdahl's law pushes the diminishing returns to 0.

If you are going to spend $50b+ on GPU hardware (and then another $50b+ on everything wrapped around them), you are going to want to invest a lot into making conservative design choices & derisking as much as possible. So a good question here is: even if that 1m mega-GPU datacenter pencils out *now* as optimal to train the next SOTA, will it *stay* optimal?

Everyone is discussing a transition to a 'search regime', where training begins to consist mostly of some sort of LLM-based search. This could happen tomorrow, or it could not happen anywhere in the foreseeable future---we just don't know.
Search usually parallelizes extremely well, and often can be made near-shared-nothing if you can split off multiple sub-trees which don't need to interact and which are of equal expected value of computation. In this scenario, where you are training LLMs on eg. outputs from transcripts generated by an AlphaZero-ish tree-search approach, the mega-GPU datacenter approach is fine. You *can* train across many datacenters in this scenario or in fact the entire consumer Internet (like Leela Zero or Stockfish do), but while maybe you wouldn't've built the mega-GPU datacenter in that case, it's as equivalent or a little bit better than what you would have, and so maybe you wound up paying 10 or 20% more to put it all into one mega-GPU datacenter, but no big deal.
So there are negative consequences of a search regime breakthrough for the hyperscalers, in terms of enabling competition from highly distributed small-timer competitors pooling compute, and AI risk consequences (models immediately scaling up to much greater intelligence if allocated more compute), it wouldn't render your hardware investment moot.

But it is not the case that that is the only possible abrupt scaling regime shift.
Instead of getting much more parallel, training could get much *less* parallel.
It's worth noting that this is the reason so much scientific computing neglected GPUs for a long time and focused more on interconnect throughput & latency: actually, *most* important scientific problems are highly serial, and deep learning is rather exceptional here---which means it may regress to the mean at some point.
There could be a new second-order SGD optimizer which cannot parallelize easily across many nodes but is so sample-efficient that it wins, or it eventually finds better optima that can't be found by regular first-order.
There could be new architectures moving back towards RNN which don't have a "parallel training mode" like Transformers, and you inherently need to move activations/gradients around nodes a ton to implement BPTT.
There could be some twist on patient-teacher/grokking-like training regimes of millions or billions of inherently serial training steps on small (even _n_ = 1) minibatches, instead of the hundreds of thousands of large minibatches which dominates LLM training now.
There could be some breakthrough in active learning or dataset distillation for a curriculum learning approach: where finding/creating the optimal datapoint is much more important than training on a lot of useless random datapoints, and so larger batches quickly hit the critical batch size.
Or something else entirely, which will seem 'obvious' in retrospect but no one is seriously thinking about now.

What sort of hardware do you want in the 'serial regime'? It would look a lot more like supercomputing than the mega-GPU datacenter.

It might force a return to high-end CPUs, overclocked to as high gigahertz as possible; however, it's hard to see what sort of serial change to DL could really cause that, aside from extreme levels of finegrained sparsity and radical changes to the underlying neural net dynamics (if still 'neural' in any sense).

More plausible is that it would continue to look mostly like current DL but highly serial: like synthesizing a datapoint to train on immediately & discard, or training in a grokking-like fashion.
In this case, one might need very few nodes---possibly as few as 1 model instances training.
This might saturate a few dozen GPUs, say, but then the rest of the mega-GPU datacenter sits idle: it can run low-value old models, but otherwise has nothing useful to do. Any attempt to help the core GPUs simply slows them down by adding in latency.

In *that* case, you don't want GPUs or CPUs. What you want is a single chip which computes forwards *and* backwards passes of a single model as fast as possible.
Groq chips don't do training, so they are right out. What comes to mind is **Cerebras**: a single ungodly fast chip is exactly their premise, and was originally justified by the same rationale given above as it applies to scientific computing.
Cerebras doesn't work all that well for the current scaling regime, but in a serial scaling regime, that could change drastically---a Cerebras chip could potentially be many times faster for each serial step (regardless of its throughput) which then translates directly to an equivalent wall-clock speedup.
(Cerebras's marketing material gives [an example](https://www.cerebras.net/blog/beyond-ai-for-wafer-scale-compute-setting-records-in-computational-fluid-dynamics/) of a linear system solver which takes ~2,000 microseconds per iteration on a CPU cluster, but only 28 microseconds on a CS-1 chip, so >200× faster per iteration.)

The implication then is that whoever has the fast serial chips can train a model and reach market years ahead of any possible competition.

If, for example, you want to train a serial model for half a year because that is just how long it takes to shatter SOTA and optimally trades-off for various factors like opportunity cost & post-training, and your chip is only 50× faster per iteration than the best available GPU (eg. 1ms to do a forwards+backwards pass vs 50ms for a Nvidia B200), then the followers would have to train for 25 years! Obviously, that's not going to happen.

Competitors would either have to obtain their own fast serial chips, accept possibly staggering levels of inefficiency in trying to parallelize, or just opt out of the competition entirely and go to the leader, hat in hand, begging to be the low-cost commodity provider just to get *some* use out of their shiny magnificently-obsolete mega-GPU datacenter.

Is this particularly likely? No. I'd give it <25% probability. We'll probably just get AGI the mundane way with some very large mega-GPU datacenters and/or a search transition. But if you *are* spending $100b+, that seems likely enough to me to be worth hedging against to the tune of, say, >$0.1b?

How would you invest/hedge?
Grok/Tenstorrent/AMD/Nvidia/Etched are all out for various reasons; only Cerebras immediately comes to mind as having the perfect chip for this.

Cerebras's last valuation was apparently $4b and they are preparing for IPO, so investing in or acquiring Cerebras may be too expensive at this point.
(This might still be a good idea for extremely wealthy investors who have passed on Cerebras due to them having no clear advantage in the current regime, and haven't considered serial regimes as a live possibility.)
Investing in a startup intended at beating Cerebras is probably also too late now, even if one knew of one.

What might work better is negotiating with Cerebras for *options* on future Cerebras hardware: Cerebras is almost certainly undervaluing the possibility of a serial regime and not investing in it (given their published research like [Kosson et al 2020](https://arxiv.org/abs/2003.11666#cerebras) focused on how to make regular large-batch training work and no publications in any of the serial regimes), and so will sell options at much less than their true option value; so you can buy options on their chips, and if the serial regime happens, just call them in and you are covered.

The most aggressive investment would be for a hyperscaler to buy Cerebras hardware *now* (with options negotiated to buy a lot of followup hardware) to try to *make* it happen.
If one's researchers crack the serial regime, then one can immediately invoke the options to more intensively R&D/choke off competition, and begin negotiating an acquisition to monopolize the supply indefinitely.
If someone else cracks the serial regime, then one at least has some serial hardware, which may only be a small factor slower, and one has sharply limited the downside: train the serial model yourself, biting the bullet of whatever inefficiency comes from having older / too litle serial hardware, but then you get a competitive model you can deploy on your mega-GPU datacenter and you have bought yourself years of breathing room while you adapt to the new serial regime.
And if neither happens, well, most insurance never pays off and your researchers may enjoy their shiny new toys and perhaps there will be some other spinoff research which actually covers the cost of the chips, so you're hardly any worse off.
